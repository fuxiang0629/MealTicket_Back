2021-11-21 14:01:41
===开始初始化最后一条数据缓存===


2021-11-21 14:01:43
===结束初始化最后一条数据缓存===


2021-11-21 14:01:44
===开始当天板块内股票快照缓存===


2021-11-21 14:01:44
===加载快照缓存===


2021-11-21 14:01:45
===加载快照缓存1===


2021-11-21 14:01:45
===加载快照缓存2===


2021-11-21 14:01:45
===加载快照缓存3===


2021-11-21 14:01:45
===加载快照缓存4===


2021-11-21 14:01:45
===结束当天板块内股票快照缓存===


2021-11-21 14:01:45
===开始加载板块计算结果缓存===


2021-11-21 14:01:46
===结束加载板块计算结果缓存===


2021-11-21 14:02:15
监听队列已链接


2021-11-21 14:05:02
执行板块K线数据补全出错
System.Data.SqlClient.SqlException (0x80131904): 列名 'SharesNumber' 无效。
   在 System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   在 System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   在 System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   在 System.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   在 System.Data.SqlClient.SqlDataReader.TryConsumeMetaData()
   在 System.Data.SqlClient.SqlDataReader.get_MetaData()
   在 System.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   在 System.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean async, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   在 System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry)
   在 System.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, String method)
   在 System.Data.SqlClient.SqlCommand.ExecuteReader(CommandBehavior behavior, String method)
   在 System.Data.SqlClient.SqlCommand.ExecuteDbDataReader(CommandBehavior behavior)
   在 System.Data.Common.DbCommand.ExecuteReader(CommandBehavior behavior)
   在 System.Data.Entity.Infrastructure.Interception.DbCommandDispatcher.<>c.<Reader>b__6_0(DbCommand t, DbCommandInterceptionContext`1 c)
   在 System.Data.Entity.Infrastructure.Interception.InternalDispatcher`1.Dispatch[TTarget,TInterceptionContext,TResult](TTarget target, Func`3 operation, TInterceptionContext interceptionContext, Action`3 executing, Action`3 executed)
   在 System.Data.Entity.Infrastructure.Interception.DbCommandDispatcher.Reader(DbCommand command, DbCommandInterceptionContext interceptionContext)
   在 System.Data.Entity.Internal.InterceptableDbCommand.ExecuteDbDataReader(CommandBehavior behavior)
   在 System.Data.Common.DbCommand.ExecuteReader(CommandBehavior behavior)
   在 System.Data.Entity.Core.Objects.ObjectContext.ExecuteStoreQueryInternal[TElement](String commandText, String entitySetName, ExecutionOptions executionOptions, Object[] parameters)
   在 System.Data.Entity.Core.Objects.ObjectContext.<>c__DisplayClass186_0`1.<ExecuteStoreQueryReliably>b__1()
   在 System.Data.Entity.Core.Objects.ObjectContext.ExecuteInTransaction[T](Func`1 func, IDbExecutionStrategy executionStrategy, Boolean startLocalTransaction, Boolean releaseConnectionOnSuccess)
   在 System.Data.Entity.Core.Objects.ObjectContext.<>c__DisplayClass186_0`1.<ExecuteStoreQueryReliably>b__0()
   在 System.Data.Entity.SqlServer.DefaultSqlExecutionStrategy.Execute[TResult](Func`1 operation)
   在 System.Data.Entity.Core.Objects.ObjectContext.ExecuteStoreQueryReliably[TElement](String commandText, String entitySetName, ExecutionOptions executionOptions, Object[] parameters)
   在 System.Data.Entity.Core.Objects.ObjectContext.ExecuteStoreQuery[TElement](String commandText, ExecutionOptions executionOptions, Object[] parameters)
   在 System.Data.Entity.Internal.InternalContext.<>c__DisplayClass111_0`1.<ExecuteSqlQuery>b__0()
   在 System.Data.Entity.Internal.LazyEnumerator`1.MoveNext()
   在 System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   在 System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   在 MealTicket_Handler.SecurityBarsData.New2_IndexSecurityBarsDataTask.DoRealTimeTask_Cal_His() 位置 D:\项目\饭票\后端\MealTicket_Handler\SecurityBarsData\新指数K线2\New2_IndexSecurityBarsDataTask.cs:行号 1038
ClientConnectionId:d5b462bd-0111-4626-ba5b-eae336000e6d
Error Number:207,State:1,Class:16

2021-11-21 14:07:00
===开始初始化最后一条数据缓存===


2021-11-21 14:07:02
===结束初始化最后一条数据缓存===


2021-11-21 14:07:02
===开始当天板块内股票快照缓存===


2021-11-21 14:07:02
===加载快照缓存===


2021-11-21 14:07:03
===加载快照缓存1===


2021-11-21 14:07:03
===加载快照缓存2===


2021-11-21 14:07:03
===加载快照缓存3===


2021-11-21 14:07:03
===加载快照缓存4===


2021-11-21 14:07:03
更新当天板块内股票快照失败
System.Exception: 今日快照已更新
   在 MealTicket_Handler.SecurityBarsData.New2_IndexSecurityBarsDataTask.UpdateTodayPlateRelSnapshot() 位置 D:\项目\饭票\后端\MealTicket_Handler\SecurityBarsData\新指数K线2\New2_IndexSecurityBarsDataTask.cs:行号 509

2021-11-21 14:07:03
===结束当天板块内股票快照缓存===


2021-11-21 14:07:03
===开始加载板块计算结果缓存===


2021-11-21 14:07:03
===结束加载板块计算结果缓存===


2021-11-21 17:41:23
SharesQuotesSession缓存加载失败
System.Data.SqlClient.SqlException (0x80131904): 在从服务器接收结果时发生传输级错误。 (provider: Session Provider, error: 19 - 物理连接不可用)
   在 System.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   在 System.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   在 System.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   在 System.Data.SqlClient.TdsParserStateObject.ReadSniError(TdsParserStateObject stateObj, UInt32 error)
   在 System.Data.SqlClient.TdsParserStateObject.ReadSniSyncOverAsync()
   在 System.Data.SqlClient.TdsParserStateObject.TryReadNetworkPacket()
   在 System.Data.SqlClient.TdsParserStateObject.TryPrepareBuffer()
   在 System.Data.SqlClient.TdsParserStateObject.TryReadByteArray(Byte[] buff, Int32 offset, Int32 len, Int32& totalRead)
   在 System.Data.SqlClient.TdsParserStateObject.TryReadInt32(Int32& value)
   在 System.Data.SqlClient.TdsParser.TryReadSqlValueInternal(SqlBuffer value, Byte tdsType, Int32 length, TdsParserStateObject stateObj)
   在 System.Data.SqlClient.TdsParser.TryReadSqlValue(SqlBuffer value, SqlMetaDataPriv md, Int32 length, TdsParserStateObject stateObj, SqlCommandColumnEncryptionSetting columnEncryptionOverride, String columnName)
   在 System.Data.SqlClient.SqlDataReader.TryReadColumnInternal(Int32 i, Boolean readHeaderOnly)
   在 System.Data.SqlClient.SqlDataReader.TryReadColumn(Int32 i, Boolean setTimeout, Boolean allowPartiallyReadColumn)
   在 System.Data.SqlClient.SqlDataReader.GetDateTime(Int32 i)
   在 lambda_method(Closure , Shaper )
   在 System.Data.Entity.Core.Common.Internal.Materialization.Coordinator`1.ReadNextElement(Shaper shaper)
   在 System.Data.Entity.Core.Common.Internal.Materialization.Shaper`1.SimpleEnumerator.MoveNext()
   在 System.Data.Entity.Internal.LazyEnumerator`1.MoveNext()
   在 System.Collections.Generic.List`1..ctor(IEnumerable`1 collection)
   在 System.Linq.Enumerable.ToList[TSource](IEnumerable`1 source)
   在 MealTicket_Handler.SharesQuotesSession.UpdateSession() 位置 D:\项目\饭票\后端\MealTicket_Handler\Session\SharesQuotesSession.cs:行号 21
   在 FXCommon.Common.Session`1._UpdateSession() 位置 D:\项目\饭票\后端\FXCommon\Common\Session.cs:行号 96
ClientConnectionId:7763103a-0851-4e12-87e2-7922b98c5c56
Error Number:-1,State:0,Class:20

2021-11-21 17:41:36
启动队列监听出错
RabbitMQ.Client.Exceptions.AlreadyClosedException: Already closed: The AMQP operation was interrupted: AMQP close-reason, initiated by Library, code=541, text='Unexpected Exception', classId=0, methodId=0, cause=System.IO.IOException: 无法从传输连接中读取数据: 远程主机强迫关闭了一个现有的连接。。 ---> System.Net.Sockets.SocketException: 远程主机强迫关闭了一个现有的连接。
   在 System.Net.Sockets.Socket.Receive(Byte[] buffer, Int32 offset, Int32 size, SocketFlags socketFlags)
   在 System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size)
   --- 内部异常堆栈跟踪的结尾 ---
   在 System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size)
   在 System.IO.BufferedStream.ReadByte()
   在 RabbitMQ.Client.Impl.InboundFrame.ReadFrom(Stream reader)
   在 RabbitMQ.Client.Impl.SocketFrameHandler.ReadFrame()
   在 RabbitMQ.Client.Framing.Impl.Connection.MainLoopIteration()
   在 RabbitMQ.Client.Framing.Impl.Connection.MainLoop()
   在 RabbitMQ.Client.Framing.Impl.Connection.EnsureIsOpen()
   在 RabbitMQ.Client.Framing.Impl.AutorecoveringConnection.EnsureIsOpen()
   在 RabbitMQ.Client.Framing.Impl.AutorecoveringConnection.CreateModel()
   在 FXCommon.MqQueue.MQTask.ListenModelConnect(Boolean isRetry) 位置 D:\项目\饭票\后端\FXCommon\MqQueue\MQTask.cs:行号 177

2021-11-21 17:41:46
SharesPlateSession缓存加载失败
System.InvalidOperationException: 超时时间已到。超时时间已到，但是尚未从池中获取连接。出现这种情况可能是因为所有池连接均在使用，并且达到了最大池大小。
   在 System.Data.ProviderBase.DbConnectionFactory.TryGetConnection(DbConnection owningConnection, TaskCompletionSource`1 retry, DbConnectionOptions userOptions, DbConnectionInternal oldConnection, DbConnectionInternal& connection)
   在 System.Data.ProviderBase.DbConnectionInternal.TryOpenConnectionInternal(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   在 System.Data.ProviderBase.DbConnectionClosed.TryOpenConnection(DbConnection outerConnection, DbConnectionFactory connectionFactory, TaskCompletionSource`1 retry, DbConnectionOptions userOptions)
   在 System.Data.SqlClient.SqlConnection.TryOpenInner(TaskCompletionSource`1 retry)
   在 System.Data.SqlClient.SqlConnection.TryOpen(TaskCompletionSource`1 retry)
   在 System.Data.SqlClient.SqlConnection.Open()
   在 System.Data.Entity.Infrastructure.Interception.DbConnectionDispatcher.<>c.<Open>b__13_0(DbConnection t, DbConnectionInterceptionContext c)
   在 System.Data.Entity.Infrastructure.Interception.InternalDispatcher`1.Dispatch[TTarget,TInterceptionContext](TTarget target, Action`2 operation, TInterceptionContext interceptionContext, Action`3 executing, Action`3 executed)
   在 System.Data.Entity.Infrastructure.Interception.DbConnectionDispatcher.Open(DbConnection connection, DbInterceptionContext interceptionContext)
   在 System.Data.Entity.Core.EntityClient.EntityConnection.<Open>b__55_0()
   在 System.Data.Entity.SqlServer.DefaultSqlExecutionStrategy.<>c__DisplayClass2_0.<Execute>b__0()
   在 System.Data.Entity.SqlServer.DefaultSqlExecutionStrategy.Execute[TResult](Func`1 operation)
   在 System.Data.Entity.SqlServer.DefaultSqlExecutionStrategy.Execute(Action operation)
   在 System.Data.Entity.Core.EntityClient.EntityConnection.Open()

2021-11-21 17:45:34
===开始初始化最后一条数据缓存===


2021-11-21 17:45:36
===结束初始化最后一条数据缓存===


2021-11-21 17:45:36
===开始当天板块内股票快照缓存===


2021-11-21 17:45:36
===加载快照缓存===


2021-11-21 17:45:37
===加载快照缓存1===


2021-11-21 17:45:37
===加载快照缓存2===


2021-11-21 17:45:37
===加载快照缓存3===


2021-11-21 17:45:37
===加载快照缓存4===


2021-11-21 17:45:37
更新当天板块内股票快照失败
System.Exception: 今日快照已更新
   在 MealTicket_Handler.SecurityBarsData.New2_IndexSecurityBarsDataTask.UpdateTodayPlateRelSnapshot() 位置 D:\项目\饭票\后端\MealTicket_Handler\SecurityBarsData\新指数K线2\New2_IndexSecurityBarsDataTask.cs:行号 509

2021-11-21 17:45:37
===结束当天板块内股票快照缓存===


2021-11-21 17:45:37
===开始加载板块计算结果缓存===


2021-11-21 17:45:37
===结束加载板块计算结果缓存===


2021-11-21 17:52:18
启动队列监听出错
RabbitMQ.Client.Exceptions.AlreadyClosedException: Already closed: The AMQP operation was interrupted: AMQP close-reason, initiated by Library, code=541, text='Unexpected Exception', classId=0, methodId=0, cause=System.IO.IOException: 无法从传输连接中读取数据: 远程主机强迫关闭了一个现有的连接。。 ---> System.Net.Sockets.SocketException: 远程主机强迫关闭了一个现有的连接。
   在 System.Net.Sockets.Socket.Receive(Byte[] buffer, Int32 offset, Int32 size, SocketFlags socketFlags)
   在 System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size)
   --- 内部异常堆栈跟踪的结尾 ---
   在 System.Net.Sockets.NetworkStream.Read(Byte[] buffer, Int32 offset, Int32 size)
   在 System.IO.BufferedStream.ReadByte()
   在 RabbitMQ.Client.Impl.InboundFrame.ReadFrom(Stream reader)
   在 RabbitMQ.Client.Impl.SocketFrameHandler.ReadFrame()
   在 RabbitMQ.Client.Framing.Impl.Connection.MainLoopIteration()
   在 RabbitMQ.Client.Framing.Impl.Connection.MainLoop()
   在 RabbitMQ.Client.Framing.Impl.Connection.EnsureIsOpen()
   在 RabbitMQ.Client.Framing.Impl.AutorecoveringConnection.EnsureIsOpen()
   在 RabbitMQ.Client.Framing.Impl.AutorecoveringConnection.CreateModel()
   在 FXCommon.MqQueue.MQTask.ListenModelConnect(Boolean isRetry) 位置 D:\项目\饭票\后端\FXCommon\MqQueue\MQTask.cs:行号 177

